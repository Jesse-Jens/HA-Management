{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Dashboard</h2>
  <a class="btn btn-secondary" href="{{ url_for('main.clients_list') }}">Manage Clients</a>
</div>
<div class="card mb-4">
  <div class="card-body">
    <canvas id="statusChart" height="100"></canvas>
  </div>
</div>
<ul class="list-group">
{% for client in clients %}
    <li class="list-group-item">{{ client.name }} - {{ client.status or 'unknown' }}</li>
{% endfor %}
</ul>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('statusChart').getContext('2d');
  const data = {
    labels: [{% for c in clients %}'{{ c.name }}',{% endfor %}],
    datasets: [{
      label: 'Status (1=ok,0=down)',
      data: [{% for c in clients %}{{ 1 if c.status=='online' else 0 }},{% endfor %}],
      backgroundColor: 'rgba(54, 162, 235, 0.5)'
    }]
  };
  new Chart(ctx, {type: 'bar', data: data, options: {scales: {y: {beginAtZero: true, max:1}}}});
</script>
{% endblock %}
